# 実装タスクリスト

- [x] 1. ルーティングの追加
  - config/routes.rb に confirm アクションを追加
  - _要件: 1.1, 2.1_

- [ ] 2. InquiriesController の拡張
  - [x] 2.1 confirm アクションの実装
    - フォームデータのバリデーション実行
    - セッションへのデータ保存
    - 確認画面への遷移処理
    - _要件: 1.1, 1.2, 1.3, 4.1_

  - [x] 2.2 create アクションの修正
    - セッションからのデータ取得
    - 再バリデーション実行
    - DB保存とメール送信処理
    - セッションクリア処理
    - _要件: 3.1, 3.2, 3.3, 3.4, 4.3_

  - [x] 2.3 back_to_form アクションの実装
    - セッションからデータを復元してフォーム画面に戻る処理
    - _要件: 2.3, 4.2_

- [ ] 3. new.html.erb の修正
  - [x] 3.1 フォームのaction先を confirm に変更
    - form_with の url を confirm_inquiries_path に変更
    - _要件: 1.1_

  - [x] 3.2 送信ボタンのテキスト変更
    - 「送信する」→「確認する」に変更
    - _要件: 1.1_

- [ ] 4. confirm.html.erb の新規作成
  - [x] 4.1 確認画面のレイアウト作成
    - ヘッダー部分の実装
    - 入力内容表示用のテーブル作成
    - _要件: 2.1, 2.2_

  - [x] 4.2 入力内容の表示実装
    - 全項目の表形式表示
    - お問い合わせ区分の日本語表示変換
    - 改行を含むテキストの適切な表示
    - _要件: 2.1_

  - [x] 4.3 ボタン配置の実装
    - 「戻る」ボタンの実装（back_to_form へのリンク）
    - 「送信する」ボタンの実装（create アクションへのフォーム）
    - _要件: 2.2, 2.3_

- [ ] 5. エラーハンドリングの実装
  - [x] 5.1 バリデーションエラー処理
    - confirm アクションでのエラー時の new 画面表示
    - create アクションでのエラー時の confirm 画面表示
    - _要件: 1.2, 3.5, 5.1, 5.3_

  - [x] 5.2 セッションエラー処理
    - セッション無効時のリダイレクト処理
    - 適切なエラーメッセージの表示
    - _要件: 4.4, 5.4_

- [ ] 6. ヘルパーメソッドの実装
  - [x] 6.1 お問い合わせ区分の日本語変換メソッド
    - inquiry_type_label ヘルパーメソッドの作成
    - _要件: 2.1_

- [ ] 7. CSS スタイリングの追加
  - [x] 7.1 確認画面用のスタイル追加
    - テーブルスタイルの実装
    - ボタン配置のスタイル調整
    - レスポンシブ対応
    - _要件: 2.1, 2.2_

- [ ] 8. 統合テストの実装
  - [ ] 8.1 正常フローのテスト
    - フォーム入力 → 確認画面 → 送信完了の一連テスト
    - _要件: 1.1, 1.3, 2.1, 3.1, 3.2, 3.3, 3.4_

  - [ ] 8.2 エラーケースのテスト
    - バリデーションエラー時の動作確認
    - セッション無効時の動作確認
    - _要件: 1.2, 3.5, 4.4_

  - [ ] 8.3 戻る機能のテスト
    - 確認画面からフォーム画面への戻り動作確認
    - データ復元の確認
    - _要件: 2.3, 4.2_