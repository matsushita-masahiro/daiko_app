<div class="dashboard">
  <h2>管理者ダッシュボード</h2>

  <div class="stats-grid">
    <!-- お問い合わせ統計カード -->
    <div class="stat-card-large">
      <h3>📧 お問い合わせ統計</h3>
      <div class="stat-grid">
        <div class="stat-item">
          <div class="stat-number"><%= @total_inquiries %></div>
          <div class="stat-label">総件数</div>
        </div>
        <div class="stat-item">
          <div class="stat-number unanswered"><%= @unanswered_inquiries %></div>
          <div class="stat-label">未回答</div>
        </div>
        <div class="stat-item">
          <div class="stat-number answered"><%= @answered_inquiries %></div>
          <div class="stat-label">回答済み</div>
        </div>
      </div>
    </div>

    <!-- アクセス統計カード -->
    <div class="stat-card-large">
      <h3>📊 アクセス統計</h3>
      <div class="stat-grid">
        <div class="stat-item">
          <div class="stat-number"><%= @total_page_views %></div>
          <div class="stat-label">総PV</div>
        </div>
        <div class="stat-item">
          <div class="stat-number"><%= @unique_visitors %></div>
          <div class="stat-label">総訪問者</div>
        </div>
        <div class="stat-item">
          <div class="stat-number"><%= @today_page_views %></div>
          <div class="stat-label">今日のPV</div>
        </div>
        <div class="stat-item">
          <div class="stat-number"><%= @today_unique_visitors %></div>
          <div class="stat-label">今日の訪問者</div>
        </div>
        <div class="stat-item">
          <div class="stat-number"><%= @this_week_page_views %></div>
          <div class="stat-label">今週のPV</div>
        </div>
        <div class="stat-item">
          <div class="stat-number"><%= @this_month_page_views %></div>
          <div class="stat-label">今月のPV</div>
        </div>
      </div>
    </div>

    <!-- 位置情報統計カード -->
    <div class="stat-card-large">
      <h3>📍 位置情報分析</h3>
      <div class="stat-grid">
        <div class="stat-item">
          <div class="stat-number"><%= @total_locations %></div>
          <div class="stat-label">総位置情報数</div>
        </div>
        <div class="stat-item">
          <div class="stat-number service-area"><%= @locations_within_service_area %></div>
          <div class="stat-label">神戸市内</div>
        </div>
        <div class="stat-item">
          <div class="stat-number outside-area"><%= @locations_outside_service_area %></div>
          <div class="stat-label">神戸市外</div>
        </div>
        <div class="stat-item">
          <div class="stat-number percentage"><%= @service_area_percentage %>%</div>
          <div class="stat-label">市内割合</div>
        </div>
        <div class="stat-item">
          <div class="stat-number"><%= @today_locations %></div>
          <div class="stat-label">今日</div>
        </div>
        <div class="stat-item">
          <div class="stat-number"><%= @this_week_locations %></div>
          <div class="stat-label">今週</div>
        </div>
        <div class="stat-item">
          <div class="stat-number"><%= @this_month_locations %></div>
          <div class="stat-label">今月</div>
        </div>
      </div>
    </div>
  </div>

  <!-- 最近の位置情報 -->
  <% if @recent_locations.any? %>
    <div class="recent-locations-section">
      <h3>📌 最近の位置情報</h3>
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>日時</th>
              <th>緯度</th>
              <th>経度</th>
              <th>エリア</th>
              <th>IPアドレス</th>
            </tr>
          </thead>
          <tbody>
            <% @recent_locations.each do |location| %>
              <tr>
                <td><%= location.visited_at.strftime('%Y/%m/%d %H:%M') %></td>
                <td><%= location.latitude.round(4) %></td>
                <td><%= location.longitude.round(4) %></td>
                <td>
                  <% if location.within_service_area? %>
                    <span class="badge badge-success">神戸市内</span>
                  <% else %>
                    <span class="badge badge-secondary">神戸市外</span>
                  <% end %>
                </td>
                <td><%= location.ip_address %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  <% end %>

  <div class="menu-section">
    <h3>メニュー</h3>
    <div class="menu-grid">
      <div class="menu-card">
        <%= link_to admin_inquiries_path, class: "menu-link" do %>
          <div class="menu-icon">📧</div>
          <h4>お問い合わせ管理</h4>
          <p>お問い合わせの確認と回答</p>
        <% end %>
      </div>
    </div>
  </div>
</div>